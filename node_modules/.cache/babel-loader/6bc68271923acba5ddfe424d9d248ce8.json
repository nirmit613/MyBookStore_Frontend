{"ast":null,"code":"var _jsxFileName = \"E:\\\\7th Semester\\\\Internship2\\\\TatvaSoft\\\\MyBookStore_Tatvasoft\\\\src\\\\pages\\\\book-listing\\\\index.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useMemo, useState } from \"react\";\nimport Pagination from \"@material-ui/lab/Pagination\";\nimport { productListingStyle } from \"./style\";\nimport { materialCommonStyles } from \"../../utils/materialCommonStyles\";\nimport { Typography, FormControl, InputLabel, Select, MenuItem, TextField, Grid } from \"@material-ui/core\";\nimport bookService from \"../../service/book.service\";\nimport { defaultFilter } from \"../../constant/constant\";\nimport categoryService from \"../../service/category.service\";\nimport { useAuthContext } from \"../../context/auth\";\nimport { toast } from \"react-toastify\";\nimport { useHistory } from \"react-router-dom\";\nimport { RoutePaths } from \"../../utils/enum\";\nimport Shared from \"../../utils/shared\";\nimport { useCartContext } from \"../../context/cart\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst BookList = () => {\n  _s();\n\n  const authContext = useAuthContext();\n  const cartContext = useCartContext();\n  const history = useHistory();\n  const classes = productListingStyle();\n  const materialClasses = materialCommonStyles();\n  const [bookList, setBookList] = useState({\n    records: [],\n    totalRecords: 0\n  });\n  const [categories, setCategories] = useState([]);\n  const [sortBy, setSortBy] = useState();\n  const [filters, setFilters] = useState(defaultFilter);\n  useEffect(() => {\n    getAllCategories();\n    GetBooks();\n  }, []);\n\n  const GetBooks = () => {\n    bookService.getAll(filters).then(res => setBookList(res));\n  };\n\n  useEffect(() => {\n    const timer = setTimeout(() => {\n      if (filters.keyword === \"\") delete filters.keyword;\n      searchAllBooks({ ...filters\n      });\n    }, 500);\n    return () => clearTimeout(timer);\n  }, [filters]);\n\n  const searchAllBooks = filters => {\n    bookService.getAll(filters).then(res => {\n      setBookList(res);\n    });\n  };\n\n  const getAllCategories = async () => {\n    await categoryService.getAll({\n      pageIndex: 0\n    }).then(res => {\n      if (res) {\n        setCategories(res.records);\n      }\n    });\n  };\n\n  const books = useMemo(() => {\n    if (bookList !== null && bookList !== void 0 && bookList.records) {\n      bookList === null || bookList === void 0 ? void 0 : bookList.records.forEach(element => {\n        var _categories$find;\n\n        element.category = (_categories$find = categories.find(a => a.id === element.categoryId)) === null || _categories$find === void 0 ? void 0 : _categories$find.name;\n      });\n      return bookList.records;\n    }\n\n    return [];\n  }, [categories, bookList]);\n\n  const addToCart = book => {\n    if (!authContext.user.id) {\n      toast.error(\"Please login before adding books to cart\");\n      history.push(RoutePaths.Register);\n      return;\n    } else {\n      Shared.addToCart(book, authContext.user.id).then(res => {\n        if (res.error) {\n          toast.error(res.message);\n        } else {\n          toast.success(res.message);\n          cartContext.updateCart();\n        }\n      });\n    }\n  };\n\n  const sortBooks = e => {\n    setSortBy(e.target.value);\n    bookList.records.sort((a, b) => {\n      if (a.name < b.name) {\n        return e.target.value === \"a-z\" ? -1 : 1;\n      }\n\n      if (a.name > b.name) {\n        return e.target.value === \"a-z\" ? 1 : -1;\n      }\n\n      return 0;\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: classes.productListWrapper,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container\",\n      children: [/*#__PURE__*/_jsxDEV(Typography, {\n        variant: \"h1\",\n        children: \"Book Listing\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(Grid, {\n        container: true,\n        className: \"title-wrapper\",\n        children: [/*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          xs: 6,\n          children: /*#__PURE__*/_jsxDEV(Typography, {\n            variant: \"h2\",\n            children: [\"Total\", /*#__PURE__*/_jsxDEV(\"span\", {\n              children: [\" - \", bookList.totalRecords, \" items\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 125,\n              columnNumber: 8\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 123,\n            columnNumber: 7\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"dropdown-wrapper\",\n          children: /*#__PURE__*/_jsxDEV(TextField, {\n            id: \"text\",\n            className: \"dropdown-wrapper\",\n            name: \"text\",\n            placeholder: \"Search...\",\n            variant: \"outlined\",\n            inputProps: {\n              className: \"small\"\n            },\n            onChange: e => {\n              setFilters({ ...filters,\n                keyword: e.target.value,\n                pageIndex: 1\n              });\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 129,\n            columnNumber: 7\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(FormControl, {\n          className: \"dropdown-wrapper\",\n          variant: \"outlined\",\n          children: [/*#__PURE__*/_jsxDEV(InputLabel, {\n            htmlFor: \"select\",\n            children: \"Sort By\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 146,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(Select, {\n            className: materialClasses.customSelect,\n            MenuProps: {\n              classes: {\n                paper: materialClasses.customSelect\n              }\n            },\n            onChange: sortBooks,\n            value: sortBy,\n            children: [/*#__PURE__*/_jsxDEV(MenuItem, {\n              value: \"a-z\",\n              children: \"a - z\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 155,\n              columnNumber: 8\n            }, this), /*#__PURE__*/_jsxDEV(MenuItem, {\n              value: \"z-a\",\n              children: \"z - a\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 156,\n              columnNumber: 8\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 147,\n            columnNumber: 7\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 6\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"product-list-wrapper\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"product-list-inner-wrapper\",\n          children: books.map(book => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"product-list\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"product-list-inner\",\n              children: [/*#__PURE__*/_jsxDEV(\"em\", {\n                children: /*#__PURE__*/_jsxDEV(\"img\", {\n                  src: book.base64image,\n                  className: \"image\",\n                  alt: \"dummy-image\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 166,\n                  columnNumber: 11\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 165,\n                columnNumber: 10\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"content-wrapper\",\n                children: [/*#__PURE__*/_jsxDEV(Typography, {\n                  variant: \"h3\",\n                  children: book.name\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 173,\n                  columnNumber: 11\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"category\",\n                  children: book.category\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 174,\n                  columnNumber: 11\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"description\",\n                  children: book.description\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 175,\n                  columnNumber: 11\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"price\",\n                  children: /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"discount-price\",\n                    children: [\"MRP \\u20B9 \", book.price]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 177,\n                    columnNumber: 12\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 176,\n                  columnNumber: 11\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"MuiButtonBase-root MuiButton-root MuiButton-contained btn pink-btn MuiButton-containedPrimary MuiButton-disableElevation\",\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"MuiButton-label\",\n                    onClick: () => addToCart(book),\n                    children: \"ADD TO CART\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 182,\n                    columnNumber: 12\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"MuiTouchRipple-root\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 188,\n                    columnNumber: 12\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 181,\n                  columnNumber: 11\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 172,\n                columnNumber: 10\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 164,\n              columnNumber: 9\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 163,\n            columnNumber: 8\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 161,\n          columnNumber: 6\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 160,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"pagination-wrapper\",\n        children: /*#__PURE__*/_jsxDEV(Pagination, {\n          count: Math.ceil((bookList !== null && bookList !== void 0 && bookList.records.length ? bookList.totalRecords : 0) / 10),\n          page: filters.pageIndex,\n          onChange: (e, newPage) => {\n            setFilters({ ...filters,\n              pageIndex: newPage\n            });\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 197,\n          columnNumber: 6\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 5\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 4\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 118,\n    columnNumber: 3\n  }, this);\n};\n\n_s(BookList, \"xm5Os0Di/8nZ2Nm2IwnedITByPE=\", false, function () {\n  return [useAuthContext, useCartContext, useHistory];\n});\n\n_c = BookList;\nexport default BookList;\n\nvar _c;\n\n$RefreshReg$(_c, \"BookList\");","map":{"version":3,"sources":["E:/7th Semester/Internship2/TatvaSoft/MyBookStore_Tatvasoft/src/pages/book-listing/index.tsx"],"names":["React","useEffect","useMemo","useState","Pagination","productListingStyle","materialCommonStyles","Typography","FormControl","InputLabel","Select","MenuItem","TextField","Grid","bookService","defaultFilter","categoryService","useAuthContext","toast","useHistory","RoutePaths","Shared","useCartContext","BookList","authContext","cartContext","history","classes","materialClasses","bookList","setBookList","records","totalRecords","categories","setCategories","sortBy","setSortBy","filters","setFilters","getAllCategories","GetBooks","getAll","then","res","timer","setTimeout","keyword","searchAllBooks","clearTimeout","pageIndex","books","forEach","element","category","find","a","id","categoryId","name","addToCart","book","user","error","push","Register","message","success","updateCart","sortBooks","e","target","value","sort","b","productListWrapper","className","customSelect","paper","map","base64image","description","price","Math","ceil","length","newPage"],"mappings":"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","sourcesContent":["import React, { useEffect, useMemo, useState } from \"react\";\r\nimport Pagination from \"@material-ui/lab/Pagination\";\r\nimport { productListingStyle } from \"./style\";\r\nimport { materialCommonStyles } from \"../../utils/materialCommonStyles\";\r\nimport {\r\n\tTypography,\r\n\tFormControl,\r\n\tInputLabel,\r\n\tSelect,\r\n\tMenuItem,\r\n\tTextField,\r\n\tGrid,\r\n} from \"@material-ui/core\";\r\nimport prodcutImage from \"../../assets/images/dummy-image.jpg\";\r\nimport BaseList from \"../../models/BaseList\";\r\nimport { BookModel } from \"../../models/BookModel\";\r\nimport FilterModel from \"../../models/FilterModel\";\r\nimport bookService from \"../../service/book.service\";\r\nimport { defaultFilter } from \"../../constant/constant\";\r\nimport categoryService from \"../../service/category.service\";\r\nimport { CategoryModel } from \"../../models/CategoryModel\";\r\nimport { AuthContextModel, useAuthContext } from \"../../context/auth\";\r\nimport { toast } from \"react-toastify\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport { RoutePaths } from \"../../utils/enum\";\r\nimport cartService from \"../../service/cart.service\";\r\nimport Shared from \"../../utils/shared\";\r\nimport { CartContext, CartContextModel, useCartContext } from \"../../context/cart\";\r\n\r\nconst BookList: React.FC = () => {\r\n\tconst authContext: AuthContextModel = useAuthContext();\r\n\tconst cartContext: CartContextModel= useCartContext();\r\n\tconst history = useHistory();\r\n\tconst classes = productListingStyle();\r\n\tconst materialClasses = materialCommonStyles();\r\n\tconst [bookList, setBookList] = useState<BaseList<BookModel[]>>({\r\n\t\trecords: [],\r\n\t\ttotalRecords: 0,\r\n\t});\r\n\tconst [categories, setCategories] = useState<CategoryModel[]>([]);\r\n\tconst [sortBy, setSortBy] = useState<\"a-z\" | \"z-a\">();\r\n\tconst [filters, setFilters] = useState<FilterModel>(defaultFilter);\r\n\r\n\tuseEffect(() => {\r\n\t\tgetAllCategories();\r\n\t\tGetBooks();\r\n\t}, []);\r\n\r\n\tconst GetBooks = () => {\r\n\t\tbookService.getAll(filters).then((res) => setBookList(res));\r\n\t};\r\n\r\n\tuseEffect(() => {\r\n\t\tconst timer: NodeJS.Timeout = setTimeout(() => {\r\n\t\t\tif (filters.keyword === \"\") delete filters.keyword;\r\n\t\t\tsearchAllBooks({ ...filters });\r\n\t\t}, 500);\r\n\t\treturn () => clearTimeout(timer);\r\n\t}, [filters]);\r\n\r\n\tconst searchAllBooks = (filters: FilterModel): void => {\r\n\t\tbookService.getAll(filters).then((res) => {\r\n\t\t\tsetBookList(res);\r\n\t\t});\r\n\t};\r\n\r\n\tconst getAllCategories = async (): Promise<void> => {\r\n\t\tawait categoryService.getAll({ pageIndex: 0 }).then((res) => {\r\n\t\t\tif (res) {\r\n\t\t\t\tsetCategories(res.records);\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\r\n\tconst books: BookModel[] = useMemo((): BookModel[] => {\r\n\t\tif (bookList?.records) {\r\n\t\t\tbookList?.records.forEach((element: BookModel) => {\r\n\t\t\t\telement.category = categories.find(\r\n\t\t\t\t\t(a) => a.id === element.categoryId\r\n\t\t\t\t)?.name;\r\n\t\t\t});\r\n\t\t\treturn bookList.records;\r\n\t\t}\r\n\t\treturn [];\r\n\t}, [categories, bookList]);\r\n\r\n\tconst addToCart = (book: BookModel): void => {\r\n\t\tif (!authContext.user.id) {\r\n\t\t\ttoast.error(\"Please login before adding books to cart\");\r\n\t\t\thistory.push(RoutePaths.Register);\r\n\t\t\treturn;\r\n\t\t} else {\r\n\t\t\tShared.addToCart(book, authContext.user.id).then(res=>{\r\n\t\t\t\tif(res.error){\r\n\t\t\t\t\ttoast.error(res.message)\r\n\t\t\t\t}else{\r\n\t\t\t\t\ttoast.success(res.message)\r\n\t\t\t\t\tcartContext.updateCart()\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t};\r\n\r\n\tconst sortBooks = (e: any) => {\r\n\t\tsetSortBy(e.target.value);\r\n\t\tbookList.records.sort((a, b) => {\r\n\t\t\tif (a.name < b.name) {\r\n\t\t\t\treturn e.target.value === \"a-z\" ? -1 : 1;\r\n\t\t\t}\r\n\t\t\tif (a.name > b.name) {\r\n\t\t\t\treturn e.target.value === \"a-z\" ? 1 : -1;\r\n\t\t\t}\r\n\t\t\treturn 0;\r\n\t\t});\r\n\t};\r\n\r\n\treturn (\r\n\t\t<div className={classes.productListWrapper}>\r\n\t\t\t<div className=\"container\">\r\n\t\t\t\t<Typography variant=\"h1\">Book Listing</Typography>\r\n\t\t\t\t<Grid container className=\"title-wrapper\">\r\n\t\t\t\t\t<Grid item xs={6}>\r\n\t\t\t\t\t\t<Typography variant=\"h2\">\r\n\t\t\t\t\t\t\tTotal\r\n\t\t\t\t\t\t\t<span> - {bookList.totalRecords} items</span>\r\n\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t</Grid>\r\n\t\t\t\t\t<div className=\"dropdown-wrapper\">\r\n\t\t\t\t\t\t<TextField\r\n\t\t\t\t\t\t\tid=\"text\"\r\n\t\t\t\t\t\t\tclassName=\"dropdown-wrapper\"\r\n\t\t\t\t\t\t\tname=\"text\"\r\n\t\t\t\t\t\t\tplaceholder=\"Search...\"\r\n\t\t\t\t\t\t\tvariant=\"outlined\"\r\n\t\t\t\t\t\t\tinputProps={{ className: \"small\" }}\r\n\t\t\t\t\t\t\tonChange={(e) => {\r\n\t\t\t\t\t\t\t\tsetFilters({\r\n\t\t\t\t\t\t\t\t\t...filters,\r\n\t\t\t\t\t\t\t\t\tkeyword: e.target.value,\r\n\t\t\t\t\t\t\t\t\tpageIndex: 1,\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<FormControl className=\"dropdown-wrapper\" variant=\"outlined\">\r\n\t\t\t\t\t\t<InputLabel htmlFor=\"select\">Sort By</InputLabel>\r\n\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\tclassName={materialClasses.customSelect}\r\n\t\t\t\t\t\t\tMenuProps={{\r\n\t\t\t\t\t\t\t\tclasses: { paper: materialClasses.customSelect },\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\tonChange={sortBooks}\r\n\t\t\t\t\t\t\tvalue={sortBy}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<MenuItem value=\"a-z\">a - z</MenuItem>\r\n\t\t\t\t\t\t\t<MenuItem value=\"z-a\">z - a</MenuItem>\r\n\t\t\t\t\t\t</Select>\r\n\t\t\t\t\t</FormControl>\r\n\t\t\t\t</Grid>\r\n\t\t\t\t<div className=\"product-list-wrapper\">\r\n\t\t\t\t\t<div className=\"product-list-inner-wrapper\">\r\n\t\t\t\t\t\t{books.map((book: BookModel) => (\r\n\t\t\t\t\t\t\t<div className=\"product-list\">\r\n\t\t\t\t\t\t\t\t<div className=\"product-list-inner\">\r\n\t\t\t\t\t\t\t\t\t<em>\r\n\t\t\t\t\t\t\t\t\t\t<img\r\n\t\t\t\t\t\t\t\t\t\t\tsrc={book.base64image}\r\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"image\"\r\n\t\t\t\t\t\t\t\t\t\t\talt=\"dummy-image\"\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t</em>\r\n\t\t\t\t\t\t\t\t\t<div className=\"content-wrapper\">\r\n\t\t\t\t\t\t\t\t\t\t<Typography variant=\"h3\">{book.name}</Typography>\r\n\t\t\t\t\t\t\t\t\t\t<span className=\"category\">{book.category}</span>\r\n\t\t\t\t\t\t\t\t\t\t<p className=\"description\">{book.description}</p>\r\n\t\t\t\t\t\t\t\t\t\t<p className=\"price\">\r\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"discount-price\">\r\n\t\t\t\t\t\t\t\t\t\t\t\tMRP &#8377; {book.price}\r\n\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t\t<button className=\"MuiButtonBase-root MuiButton-root MuiButton-contained btn pink-btn MuiButton-containedPrimary MuiButton-disableElevation\">\r\n\t\t\t\t\t\t\t\t\t\t\t<span\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"MuiButton-label\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => addToCart(book)}\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\tADD TO CART\r\n\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"MuiTouchRipple-root\"></span>\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t))}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"pagination-wrapper\">\r\n\t\t\t\t\t<Pagination\r\n\t\t\t\t\t\tcount={Math.ceil(\r\n\t\t\t\t\t\t\t(bookList?.records.length ? bookList.totalRecords : 0) / 10\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t\tpage={filters.pageIndex}\r\n\t\t\t\t\t\tonChange={(e, newPage) => {\r\n\t\t\t\t\t\t\tsetFilters({ ...filters, pageIndex: newPage });\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default BookList;\r\n"]},"metadata":{},"sourceType":"module"}