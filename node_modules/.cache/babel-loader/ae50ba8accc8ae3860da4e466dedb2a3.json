{"ast":null,"code":"import axios from \"axios\";\nimport { toast } from \"react-toastify\";\nconst request = axios.create({\n  //  baseURL: \"https://web1.anasource.com/BookStore/api/BookStore/\", // url = base url + request url\n  // baseURL: 'https://localhost:44394/',\n  //baseURL: \"https://helperland1.azurewebsites.net/\",\n  //  baseURL: \"http://192.168.1.20/\",\n  baseURL: \"https://localhost:44301/swagger/index.html\",\n  timeout: 12400000,\n  responseType: \"json\"\n});\nlet requests = [];\nlet conflictRequest = \"\"; // Request interceptors Customize based on your need\n\nrequest.interceptors.request.use(async config => {\n  if (config.headers) {\n    config.headers[\"Content-Type\"] = \"application/json\";\n  }\n\n  if (config.headers[\"isDisableLoader\"] !== true) {\n    requests.push(config.url);\n    showLoader();\n  }\n\n  return config;\n}, error => {\n  alert(error);\n  Promise.reject(error);\n}); // Response interceptors Customize based on your need\n\nrequest.interceptors.response.use(response => {\n  const {\n    data\n  } = response;\n  removeRequest(response.config.url);\n\n  if (data !== null && data !== void 0 && data.code && (data === null || data === void 0 ? void 0 : data.code) !== \"OK\") {\n    return Promise.reject(new Error(data.detail || \"Error\"));\n  } else {\n    return Promise.resolve(response);\n  }\n}, error => {\n  removeRequest(error.config.url);\n  toast.error(error.response.data.detail);\n  return Promise.reject(error);\n});\n\nfunction showLoader() {\n  document.body.classList.add(\"loader-open\");\n}\n\nfunction hideLoader() {\n  document.body.classList.remove(\"loader-open\");\n} // remove completed request\n\n\nfunction removeRequest(req) {\n  const i = requests.indexOf(req);\n\n  if (i >= 0) {\n    requests.splice(i, 1);\n  }\n\n  if (requests.length > 0) {\n    showLoader();\n  } else {\n    hideLoader();\n  }\n\n  if (req === conflictRequest) {\n    conflictRequest = \"\";\n    requests = requests.filter(request => request !== req);\n  }\n}\n\nexport default request;","map":{"version":3,"sources":["E:/7th Semester/Internship2/TatvaSoft/MyBookStore_Tatvasoft/src/service/request.ts"],"names":["axios","toast","request","create","baseURL","timeout","responseType","requests","conflictRequest","interceptors","use","config","headers","push","url","showLoader","error","alert","Promise","reject","response","data","removeRequest","code","Error","detail","resolve","document","body","classList","add","hideLoader","remove","req","i","indexOf","splice","length","filter"],"mappings":"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","sourcesContent":["import axios from \"axios\";\r\nimport { toast } from \"react-toastify\";\r\n\r\nconst request = axios.create({\r\n\t//  baseURL: \"https://web1.anasource.com/BookStore/api/BookStore/\", // url = base url + request url\r\n\t// baseURL: 'https://localhost:44394/',\r\n\t//baseURL: \"https://helperland1.azurewebsites.net/\",\r\n\t//  baseURL: \"http://192.168.1.20/\",\r\n\tbaseURL : \"https://localhost:44301/swagger/index.html\",\r\n\ttimeout: 12400000,\r\n\tresponseType: \"json\",\r\n});\r\n\r\nlet requests: string[] = [];\r\nlet conflictRequest: string = \"\";\r\n\r\n// Request interceptors Customize based on your need\r\nrequest.interceptors.request.use(\r\n\tasync (config: any) => {\r\n\t\tif (config.headers) {\r\n\t\t\tconfig.headers[\"Content-Type\"] = \"application/json\";\r\n\t\t}\r\n\r\n\t\tif (config.headers[\"isDisableLoader\"] !== true) {\r\n\t\t\trequests.push(config.url);\r\n\t\t\tshowLoader();\r\n\t\t}\r\n\r\n\t\treturn config;\r\n\t},\r\n\t(error: any) => {\r\n\t\talert(error);\r\n\t\tPromise.reject(error);\r\n\t}\r\n);\r\n\r\n// Response interceptors Customize based on your need\r\nrequest.interceptors.response.use(\r\n\t(response: any) => {\r\n\t\tconst { data } = response;\r\n\t\tremoveRequest(response.config.url);\r\n\t\tif (data?.code && data?.code !== \"OK\") {\r\n\t\t\treturn Promise.reject(new Error(data.detail || \"Error\"));\r\n\t\t} else {\r\n\t\t\treturn Promise.resolve(response);\r\n\t\t}\r\n\t},\r\n\t(error: any) => {\r\n\t\tremoveRequest(error.config.url);\r\n\t\ttoast.error(error.response.data.detail);\r\n\t\treturn Promise.reject(error);\r\n\t}\r\n);\r\n\r\nfunction showLoader() {\r\n\tdocument.body.classList.add(\"loader-open\");\r\n}\r\n\r\nfunction hideLoader() {\r\n\tdocument.body.classList.remove(\"loader-open\");\r\n}\r\n\r\n// remove completed request\r\nfunction removeRequest(req: string) {\r\n\tconst i = requests.indexOf(req);\r\n\tif (i >= 0) {\r\n\t\trequests.splice(i, 1);\r\n\t}\r\n\tif (requests.length > 0) {\r\n\t\tshowLoader();\r\n\t} else {\r\n\t\thideLoader();\r\n\t}\r\n\tif (req === conflictRequest) {\r\n\t\tconflictRequest = \"\";\r\n\t\trequests = requests.filter((request) => request !== req);\r\n\t}\r\n}\r\n\r\nexport default request;\r\n"]},"metadata":{},"sourceType":"module"}